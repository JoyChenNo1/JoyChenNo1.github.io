<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><!-- hexo injector head_begin start --><link href="https://cdn.jsdelivr.net/npm/hexo-tag-common@latest/css/index.css" rel="stylesheet"/><!-- hexo injector head_begin end --><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>设计模式原则概要 | JoyChen's 知识星球</title><meta name="keywords" content="设计模式"><meta name="author" content="JoyChen"><meta name="copyright" content="JoyChen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="设计模式的七大原则(The 7 Principles of Design Patterns)面向对象的 5 大原则(SOLID) + 其他 2 种原则: 单一职责原则（Single Responsibility Principle, SRP） 开闭原则（Open Closed Principle，OCP） 里氏替换原则（Liskov Substitution Principle，LSP） 接口隔离">
<meta property="og:type" content="article">
<meta property="og:title" content="设计模式原则概要">
<meta property="og:url" content="http://example.com/2020/07/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%8E%9F%E5%88%99%E6%A6%82%E8%A6%81/index.html">
<meta property="og:site_name" content="JoyChen&#39;s 知识星球">
<meta property="og:description" content="设计模式的七大原则(The 7 Principles of Design Patterns)面向对象的 5 大原则(SOLID) + 其他 2 种原则: 单一职责原则（Single Responsibility Principle, SRP） 开闭原则（Open Closed Principle，OCP） 里氏替换原则（Liskov Substitution Principle，LSP） 接口隔离">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/img/random/material-3.png">
<meta property="article:published_time" content="2020-07-13T12:08:00.000Z">
<meta property="article:modified_time" content="2024-03-21T06:06:55.361Z">
<meta property="article:author" content="JoyChen">
<meta property="article:tag" content="设计模式">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/img/random/material-3.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2020/07/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%8E%9F%E5%88%99%E6%A6%82%E8%A6%81/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '设计模式原则概要',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-03-21 14:06:55'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/font.css"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">63</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">44</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/img/random/material-3.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">JoyChen's 知识星球</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">设计模式原则概要</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-07-13T12:08:00.000Z" title="发表于 2020-07-13 20:08:00">2020-07-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-03-21T06:06:55.361Z" title="更新于 2024-03-21 14:06:55">2024-03-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="设计模式的七大原则-The-7-Principles-of-Design-Patterns"><a href="#设计模式的七大原则-The-7-Principles-of-Design-Patterns" class="headerlink" title="设计模式的七大原则(The 7 Principles of Design Patterns)"></a>设计模式的七大原则(The 7 Principles of Design Patterns)</h2><h3 id="面向对象的-5-大原则-SOLID-其他-2-种原则"><a href="#面向对象的-5-大原则-SOLID-其他-2-种原则" class="headerlink" title="面向对象的 5 大原则(SOLID) + 其他 2 种原则:"></a>面向对象的 5 大原则(SOLID) + 其他 2 种原则:</h3><ul>
<li>单一职责原则（Single Responsibility Principle, SRP）</li>
<li>开闭原则（Open Closed Principle，OCP）</li>
<li>里氏替换原则（Liskov Substitution Principle，LSP）</li>
<li>接口隔离原则（Interface Segregation Principle，ISP）</li>
<li>依赖倒置原则（Dependency Inversion Principle，DIP）</li>
<li>合成&#x2F;聚合复用原则（Composite&#x2F;Aggregate Reuse Principle，CARP）</li>
<li>最少知识原则（Least Knowledge Principle，LKP）或者迪米特法则（Law of  Demeter，LOD）</li>
</ul>
<table>
<thead>
<tr>
<th align="left">标记</th>
<th align="left">设计模式原则名称</th>
<th align="left">简单定义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">SRP</td>
<td align="left">单一职责原则</td>
<td align="left">一个类只负责一个功能领域中的相应职责</td>
</tr>
<tr>
<td align="left">OCP</td>
<td align="left">开闭原则</td>
<td align="left">对扩展开放，对修改关闭</td>
</tr>
<tr>
<td align="left">LSP</td>
<td align="left">里氏替换原则</td>
<td align="left">所有引用基类的地方必须能透明地使用其子类的对象</td>
</tr>
<tr>
<td align="left">ISP</td>
<td align="left">接口隔离原则</td>
<td align="left">类之间的依赖关系应该建立在最小的接口上</td>
</tr>
<tr>
<td align="left">DIP</td>
<td align="left">依赖倒置原则</td>
<td align="left">依赖于抽象，不能依赖于具体实现</td>
</tr>
<tr>
<td align="left">CARP</td>
<td align="left">合成&#x2F;聚合复用原则</td>
<td align="left">尽量使用合成&#x2F;聚合，而不是通过继承达到复用的目的</td>
</tr>
<tr>
<td align="left">LOD</td>
<td align="left">迪米特法则</td>
<td align="left">一个软件实体应当尽可能少的与其他实体发生相互作用</td>
</tr>
</tbody></table>
<br/>

<h4 id="单一职责原则-Single-Responsibility-Principle"><a href="#单一职责原则-Single-Responsibility-Principle" class="headerlink" title="单一职责原则(Single Responsibility Principle)"></a>单一职责原则(Single Responsibility Principle)</h4><div class="tabs" id="单一职责原则"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#单一职责原则-1">SRP</button></li><li class="tab"><button type="button" data-href="#单一职责原则-2">Bad case Journal</button></li><li class="tab"><button type="button" data-href="#单一职责原则-3">SRP Good Case</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="单一职责原则-1"><p>  单一职责原则（SRP：Single responsibility principle）：一个类应该<strong>只有一个发生变化的原因</strong>，即一个类<strong>只负责一项职责</strong>。</p>
<p>  如果一个类有多个职责，这些职责就耦合在了一起。当一个职责发生变化时，可能会影响其它的职责。另外，多个职责耦合在一起会影响复用性。</p>
<p>此原则的核心是<strong>解耦</strong>和<strong>增强内聚性</strong>。</p>
<p>  遵循 SRP。分别建立两个类 A1、A2，使 A1 完成职责 P1，A2 完成职责 P2。这样，当修改类 A1 时，不会影响到职责 A2；同理，当修改 A2 时，也不会影响到职责 P1。</p>
<p>each class has only one responsibility, and therefore has only one reason to change!</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="单一职责原则-2"><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Journal</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">explicit</span> <span class="token function">Journal</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> title<span class="token punctuation">)</span> 
    <span class="token operator">:</span> <span class="token function">title_</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    
  <span class="token punctuation">&#125;</span>
  <span class="token comment">// one functionality of the Journal</span>
  <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> entry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  	<span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  	entries<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
<span class="token keyword">private</span><span class="token operator">:</span>
  std<span class="token double-colon punctuation">::</span>string title<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token operator">></span> entries<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// break the Single Responsibility Principle!!!</span>
<span class="token comment">// The Journal's responsibility is to keep journal entries, </span>
<span class="token comment">// not to write them to disk !!! </span>
<span class="token keyword">void</span> <span class="token class-name">Journal</span><span class="token double-colon punctuation">::</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> filename<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  std<span class="token double-colon punctuation">::</span>ostream <span class="token function">ofs</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> e <span class="token operator">:</span> entries<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    ofs <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="单一职责原则-3"><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// each class has one responsibility</span>
<span class="token keyword">class</span> <span class="token class-name">Journal</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">explicit</span> <span class="token function">Journal</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> title<span class="token punctuation">)</span> 
    <span class="token operator">:</span> <span class="token function">title_</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    
  <span class="token punctuation">&#125;</span>
  <span class="token comment">// one functionality of the Journal</span>
  <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> entry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  	<span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">// if thre's something more that needs to be done...</span>
  	entries<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"test-"</span> <span class="token operator">+</span> entry<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// such as we can change here in Add() function</span>
  <span class="token punctuation">&#125;</span>
  
<span class="token keyword">private</span><span class="token operator">:</span>
  std<span class="token double-colon punctuation">::</span>string title<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token operator">></span> entries<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">PersistenceManager</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Save</span><span class="token punctuation">(</span><span class="token keyword">const</span> Journal<span class="token operator">&amp;</span> j<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> filename<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    std<span class="token double-colon punctuation">::</span>ostream <span class="token function">ofs</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> e <span class="token operator">:</span> entries<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      ofs <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<br/>

<h4 id="开闭原则-Open-Closed-Principle"><a href="#开闭原则-Open-Closed-Principle" class="headerlink" title="开闭原则(Open Closed Principle)"></a>开闭原则(Open Closed Principle)</h4><div class="tabs" id="单一职责原则"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#单一职责原则-1">OCP</button></li><li class="tab"><button type="button" data-href="#单一职责原则-2">OCP Bad Case</button></li><li class="tab"><button type="button" data-href="#单一职责原则-3">OCP Good Case</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="单一职责原则-1"><p>  开闭原则（OCP ：Open Closed Principle）：软件中的<strong>实体（类，模块，函数等等）</strong>应该<strong>对扩展开放，对修改封闭</strong>，这意味着一个实体是允许在<strong>不改变它的源代码的前提下变更它的行为</strong>。</p>
<p>  开闭原则<strong>对扩展开放，对修改封闭</strong>，该特性在产品化的环境中是特别有价值的，在这种环境中，改变源代码需要<strong>代码审查，单元测试</strong>以及诸如此类的用以确保产品使用品质的过程。遵循这种原则的代码<strong>在扩展时并不发生改变，因此无需上述的过程</strong>。</p>
<p>A type is open for extention but closed for modification !!!</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="单一职责原则-2"><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">enum</span> <span class="token keyword">class</span> <span class="token class-name">Color</span> <span class="token punctuation">&#123;</span>
  Red <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  Green <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  Blue <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">enum</span> <span class="token keyword">class</span> <span class="token class-name">Size</span> <span class="token punctuation">&#123;</span>
  Small <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  Medium <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  Large <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Product</span> <span class="token punctuation">&#123;</span>
  string name<span class="token punctuation">;</span>
  Color color<span class="token punctuation">;</span>
  Size size<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>


<span class="token comment">// Now, we want to provide certain filtering capabilities </span>
<span class="token comment">// for a given set of products</span>
<span class="token keyword">class</span> <span class="token class-name">ProductFilter</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Product<span class="token operator">*</span><span class="token operator">></span> Items<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  Items <span class="token function">ByColor</span><span class="token punctuation">(</span>Items<span class="token operator">&amp;</span> items<span class="token punctuation">,</span> Color color<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    Items result<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> i <span class="token operator">:</span> items<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">-></span>color <span class="token operator">==</span> color<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        result<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// some time later, we asked to implement filtering by size,</span>
<span class="token comment">// if we jump back into ProductFilter and add the fucking code and recompile,</span>
<span class="token comment">// we break the OCP!!!</span>
<span class="token keyword">class</span> <span class="token class-name">ProductFilter</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// ...</span>
  Items <span class="token function">BySize</span><span class="token punctuation">(</span>Items<span class="token operator">&amp;</span> items<span class="token punctuation">,</span> Size size<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">&#125;</span>
    
  <span class="token comment">// other filters implements...</span>
  <span class="token comment">// oops...</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="单一职责原则-3"><p>We want filtering that is extensible without having modify it !!!</p>
<p>How can we achieve it? Well, first of all, we conceptually separate(SRP)!</p>
<p>out filtering process into two parts: a filter(a process which takes all items and only return some) and a specication(the definition of a predicate to apply to a data element).</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">enum</span> <span class="token keyword">class</span> <span class="token class-name">Color</span> <span class="token punctuation">&#123;</span>
  Red <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  Green <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  Blue <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">enum</span> <span class="token keyword">class</span> <span class="token class-name">Size</span> <span class="token punctuation">&#123;</span>
  Small <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  Medium <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  Large <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">Product</span> <span class="token punctuation">&#123;</span>
  string name<span class="token punctuation">;</span>
  Color color<span class="token punctuation">;</span>
  Size size<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// make a very simple definition of a specification interface</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">Specification</span> <span class="token punctuation">&#123;</span>
 <span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">virtual</span> <span class="token keyword">bool</span> <span class="token function">IsSatisfied</span><span class="token punctuation">(</span>T<span class="token operator">*</span> item<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">Filter</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">virtual</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">*</span><span class="token operator">></span> <span class="token function">Filter</span><span class="token punctuation">(</span>Specification<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> spec<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// implementations of filter is really simple</span>
<span class="token keyword">class</span> <span class="token class-name">ExcellentFilter</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Filter</span><span class="token operator">&lt;</span><span class="token class-name">Product</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Product<span class="token operator">*</span><span class="token operator">></span> <span class="token function">Filter</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Product<span class="token operator">*</span><span class="token operator">></span> items<span class="token punctuation">,</span> Specification<span class="token operator">&lt;</span>Product<span class="token operator">></span><span class="token operator">&amp;</span> spec<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span>
    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Product<span class="token operator">*</span><span class="token operator">></span> result<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> p <span class="token operator">:</span> items<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>spc<span class="token punctuation">.</span><span class="token function">IsSatisfied</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        result<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// to make a lot of different filters is easy</span>
<span class="token keyword">class</span> <span class="token class-name">ColorSpecification</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Specification</span><span class="token operator">&lt;</span><span class="token class-name">Product</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">explicit</span>  <span class="token function">ColorSpecification</span><span class="token punctuation">(</span><span class="token keyword">const</span> Color color<span class="token punctuation">)</span> 
    <span class="token operator">:</span> <span class="token function">color_</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  <span class="token keyword">bool</span> <span class="token function">IsSatisfied</span><span class="token punctuation">(</span>Product<span class="token operator">*</span> item<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> item<span class="token operator">-></span>color <span class="token operator">==</span> color_<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
<span class="token keyword">private</span><span class="token operator">:</span>
  Color color_<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// complicated Specification</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">AndSpecification</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Specification</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token function">AndSpecification</span><span class="token punctuation">(</span>Specification<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> first<span class="token punctuation">,</span> Specification<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> second<span class="token punctuation">)</span> 
    <span class="token operator">:</span> <span class="token function">first_</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">second_</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      
    <span class="token punctuation">&#125;</span>
  <span class="token keyword">bool</span> <span class="token function">IsSatisfied</span><span class="token punctuation">(</span>T<span class="token operator">*</span> item<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> first_<span class="token punctuation">.</span><span class="token function">IsSatisfied</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> sencond_<span class="token punctuation">.</span><span class="token function">IsSatisfied</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
<span class="token keyword">private</span><span class="token operator">:</span>
  Specification<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> first_<span class="token punctuation">;</span>
  Specification<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> sencond_<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Product<span class="token operator">*</span><span class="token operator">></span> all <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token operator">&amp;</span>Product<span class="token punctuation">&#123;</span><span class="token string">"Tree"</span><span class="token punctuation">,</span> Color<span class="token double-colon punctuation">::</span>Green<span class="token punctuation">,</span> Size<span class="token double-colon punctuation">::</span>Large<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token operator">&amp;</span>Product<span class="token punctuation">&#123;</span><span class="token string">"Apple"</span><span class="token punctuation">,</span> Color<span class="token double-colon punctuation">::</span>Green<span class="token punctuation">,</span> Size<span class="token double-colon punctuation">::</span>Small<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token operator">&amp;</span>Product<span class="token punctuation">&#123;</span><span class="token string">"House"</span><span class="token punctuation">,</span> Color<span class="token double-colon punctuation">::</span>Blue<span class="token punctuation">,</span> Size<span class="token double-colon punctuation">::</span>Large<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  
  ExcellentFilter filter<span class="token punctuation">;</span>
  
  ColorSpecification <span class="token function">green_spec</span><span class="token punctuation">(</span>Color<span class="token double-colon punctuation">::</span>Green<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ColorSpecification <span class="token function">small_spec</span><span class="token punctuation">(</span>Size<span class="token double-colon punctuation">::</span>Small<span class="token punctuation">)</span><span class="token punctuation">;</span>
  AndSpecification<span class="token operator">&lt;</span>Product<span class="token operator">></span> green_and_small_spec<span class="token punctuation">&#123;</span>green_spec<span class="token punctuation">,</span> small_spec<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  
  <span class="token keyword">auto</span> green_stuff <span class="token operator">=</span> filter<span class="token punctuation">.</span><span class="token function">Filter</span><span class="token punctuation">(</span>all<span class="token punctuation">,</span> green_spec<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">auto</span> small_and_green_stuff <span class="token operator">=</span> filter<span class="token punctuation">.</span><span class="token function">Filter</span><span class="token punctuation">(</span>all<span class="token punctuation">,</span> green_and_small_spec<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<br/>

<h4 id="里氏替换原则-Liskov-Substitution-Principle"><a href="#里氏替换原则-Liskov-Substitution-Principle" class="headerlink" title="里氏替换原则(Liskov Substitution Principle)"></a>里氏替换原则(Liskov Substitution Principle)</h4><div class="tabs" id="里氏替换原则"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#里氏替换原则-1">LSP</button></li><li class="tab"><button type="button" data-href="#里氏替换原则-2">LSP Bad Case</button></li><li class="tab"><button type="button" data-href="#里氏替换原则-3">LSP Good Case</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="里氏替换原则-1"><p>里氏替换原则（LSP：Liskov Substitution Principle）：<strong>派生类（子类）对象可以在程序中代替其基类（超类）对象</strong>。</p>
<p>有一功能 P1, 由类 A 完成，现需要将功能 P1 进行扩展，扩展后的功能为 P，其中 P 由原有功能 P1 与新功能 P2 组成。新功能 P 由类 A 的子类 B 来完成，则子类 B 在完成新功能 P2 的同时，有可能会导致原有功能 P1 发生故障。</p>
<p>当使用继承时候，类 B 继承类 A 时，<strong>除添加新的方法完成新增功能 P2，尽量不要修改父类方法预期的行为</strong>。</p>
<ul>
<li>里氏替换原则是<strong>实现开闭原则的重要方式之一</strong>。</li>
<li>里氏替换原则<strong>克服</strong>了继承中重写父类造成的<strong>可复用性变差的缺点</strong>。</li>
<li>里氏替换原则是动作正确性的保证。即<strong>类的扩展不会给已有的系统引入新的错误</strong>，降低了代码出错的可能性。</li>
<li>加强程序的<strong>健壮性</strong>，同时变更时可以做到非常好的<strong>兼容性</strong>，提高程序的维护性、可扩展性，降低需求变更时引入的风险。</li>
</ul>
<p>If an interface takes an object of type Parent, it should equally take an object of type Child without anything breaking.</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="里氏替换原则-2"><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
  <span class="token keyword">int</span> width_<span class="token punctuation">,</span> height_<span class="token punctuation">;</span>
  
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">width_</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">height_</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  <span class="token keyword">int</span> <span class="token function">get_width</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">return</span> width_<span class="token punctuation">;</span> 
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">set_width</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> w<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">this</span><span class="token operator">-></span>width_ <span class="token operator">=</span> w<span class="token punctuation">;</span> 
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">int</span> <span class="token function">get_height</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">return</span> height_<span class="token punctuation">;</span> 
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">set_height</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> h<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">this</span><span class="token operator">-></span>height_ <span class="token operator">=</span> h<span class="token punctuation">;</span> 
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">int</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">return</span> width_ <span class="token operator">*</span> height_<span class="token punctuation">;</span> 
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// suppose we make a special kind of Rectangle called a Square</span>

<span class="token keyword">class</span> <span class="token class-name">Square</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Rectangle</span></span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token function">Square</span><span class="token punctuation">(</span><span class="token keyword">int</span> size<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Retangle</span><span class="token punctuation">(</span>size<span class="token punctuation">,</span> size<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  <span class="token keyword">void</span> <span class="token function">set_width</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> w<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token operator">-></span>width_ <span class="token operator">=</span> w<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">set_height</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> h<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span> 
    <span class="token keyword">this</span><span class="token operator">-></span>height_ <span class="token operator">=</span> h<span class="token punctuation">;</span> 
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// evil approach !!!</span>
<span class="token keyword">void</span> <span class="token function">process</span><span class="token punctuation">(</span>Rectangle<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> w <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">get_width</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  r<span class="token punctuation">.</span><span class="token function">set_height</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"expected area = "</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>w <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">", got "</span> <span class="token operator">&lt;&lt;</span> r<span class="token punctuation">.</span><span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// The preceding function takes </span>
<span class="token comment">// the formula Area = Width × Height as an invariant. </span>
<span class="token comment">// It gets the width, sets the height, </span>
<span class="token comment">// and rightly expects the product to </span>
<span class="token comment">// be equal to the calculated area. </span>
<span class="token comment">// But calling the preceding function </span>
<span class="token comment">// with a Square yields a mismatch:</span>
<span class="token comment">// Square s&#123;5&#125;;</span>
<span class="token comment">// process(s); // expected area = 50, got 25</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>process() breaks the LSP by being thoroughly unable to take a derived type Square instead of the base type Rectangle.</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="里氏替换原则-3"><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// What’s the solution? Well, there are many. </span>
<span class="token comment">// Personally, I’d argue that </span>
<span class="token comment">// the type Square shouldn’t even exist : </span>
<span class="token comment">// instead, we can make a Factory (see Chapter 3) that </span>
<span class="token comment">// creates both rectangles and squares:</span>
<span class="token keyword">struct</span> <span class="token class-name">RectangleFactory</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">static</span> Rectangle <span class="token function">create_rectangle</span><span class="token punctuation">(</span><span class="token keyword">int</span> w<span class="token punctuation">,</span> <span class="token keyword">int</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> Rectangle <span class="token function">create_square</span><span class="token punctuation">(</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// You might also want a way of detecting that a Rectangle is, in fact, a square:</span>
<span class="token keyword">bool</span> <span class="token class-name">Rectangle</span><span class="token double-colon punctuation">::</span><span class="token function">is_square</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> width <span class="token operator">==</span> height<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// The nuclear option, in this case, </span>
<span class="token comment">// would be to throw an exception in </span>
<span class="token comment">// Square’s set_width()/set_height(), </span>
<span class="token comment">// stating that these operations are </span>
<span class="token comment">// unsupported and you should be using </span>
<span class="token comment">// set_size() instead. </span>
<span class="token comment">// This, however, violates the principle of </span>
<span class="token comment">// least surpise, since you would expect </span>
<span class="token comment">// a call to set_width() to make a meaningful change</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<br/>



<h4 id="接口隔离原则-Interface-Segregation-Principle"><a href="#接口隔离原则-Interface-Segregation-Principle" class="headerlink" title="接口隔离原则(Interface Segregation Principle)"></a>接口隔离原则(Interface Segregation Principle)</h4><div class="tabs" id="接口隔离原则"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#接口隔离原则-1">ISP</button></li><li class="tab"><button type="button" data-href="#接口隔离原则-2">ISP Bad Case</button></li><li class="tab"><button type="button" data-href="#接口隔离原则-3">ISP Good Case</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="接口隔离原则-1"><p>接口隔离原则（ISP ：Interface Segregation Principle）：客户端<strong>不应该依赖它不需要的接口</strong>。一个类对另一个类的依赖应该建立在<strong>最小的接口</strong>上。</p>
<p>类 A 通过接口 I 依赖类 B，类 C 通过接口 I 依赖类 D，如果接口 I 对于类 A 和类 B 来说不是最小接口，则类 B 和类 D 必须去实现他们不需要的方法。</p>
<p><strong>将臃肿的接口 I 拆分为独立的几个接口</strong>，类 A 和类 C 分别与他们需要的接口建立依赖关系。</p>
<p>Suggests is that you split up interfaces so that implementors can pick and choose depending on their needs.</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="接口隔离原则-2"><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">MyFavouritePrinter</span> <span class="token comment">/* : public IMachine */</span> <span class="token punctuation">&#123;</span>
 <span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Document<span class="token operator">*</span><span class="token operator">></span> docs<span class="token punctuation">)</span> <span class="token keyword">override</span><span class="token punctuation">;</span>

  <span class="token keyword">void</span> <span class="token function">fax</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Document<span class="token operator">*</span><span class="token operator">></span> docs<span class="token punctuation">)</span> <span class="token keyword">override</span><span class="token punctuation">;</span>

  <span class="token keyword">void</span> <span class="token function">scan</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Document<span class="token operator">*</span><span class="token operator">></span> docs<span class="token punctuation">)</span> <span class="token keyword">override</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// some implementor of this interface </span>
<span class="token comment">// might not need scanning or faxing, </span>
<span class="token comment">// just printing. And yet, </span>
<span class="token comment">// you are forcing them to implement those extra features</span>
<span class="token keyword">class</span> <span class="token class-name">IMachine</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Document<span class="token operator">*</span><span class="token operator">></span> docs<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">fax</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Document<span class="token operator">*</span><span class="token operator">></span> docs<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">scan</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Document<span class="token operator">*</span><span class="token operator">></span> docs<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="接口隔离原则-3"><p>To segregate parts of a complicated interface into separate interfaces so as to avoid forcing implementors to implement functionality that they do not really need. Anytime you write<br>a plug-in for some complicated application and you’re given an interface with 20 confusing functions to implement with various no-ops and return nullptr, more likely than not the API authors have violated the ISP.</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">IPrinter</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>Document<span class="token operator">*</span><span class="token operator">></span> docs<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">IScanner</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">scan</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>Document<span class="token operator">*</span><span class="token operator">></span> docs<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Printer</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">IPrinter</span></span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>Document<span class="token operator">*</span><span class="token operator">></span> docs<span class="token punctuation">)</span> <span class="token keyword">override</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Scanner</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">IScanner</span></span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">void</span> <span class="token function">scan</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>Document<span class="token operator">*</span><span class="token operator">></span> docs<span class="token punctuation">)</span> <span class="token keyword">override</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// if we really want an IMachine interface, </span>
<span class="token comment">// we can define it as a combination of </span>
<span class="token comment">// the aforementioned interfaces:</span>
<span class="token keyword">class</span> <span class="token class-name">IMachine</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">IPrinter</span><span class="token punctuation">,</span> <span class="token class-name">IScanner</span> <span class="token comment">/* IFax and so on */</span></span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">// we could use simple delegation to ensure that </span>
<span class="token comment">// Machine reuses the functionality provided by </span>
<span class="token comment">// a particular IPrinter and IScanner:</span>
<span class="token keyword">class</span> <span class="token class-name">Machine</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">IMachine</span></span> <span class="token punctuation">&#123;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
  IPrinter<span class="token operator">&amp;</span> printer_<span class="token punctuation">;</span>
  IScanner<span class="token operator">&amp;</span> scanner_<span class="token punctuation">;</span>
 
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token function">Machine</span><span class="token punctuation">(</span>IPrinter<span class="token operator">&amp;</span> printer<span class="token punctuation">,</span> IScanner<span class="token operator">&amp;</span> scanner<span class="token punctuation">)</span> 
    <span class="token operator">:</span> <span class="token function">printer_</span><span class="token punctuation">(</span>printer<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">scanner_</span><span class="token punctuation">(</span>scanner<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Document<span class="token operator">*</span><span class="token operator">></span> docs<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token operator">-></span>printer_<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">void</span> <span class="token function">scan</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Document<span class="token operator">*</span><span class="token operator">></span> docs<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token operator">-></span>scanner_<span class="token punctuation">.</span><span class="token function">scan</span><span class="token punctuation">(</span>docs<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<br/>



<h4 id="依赖倒置原则-Dependency-Inversion-Principle"><a href="#依赖倒置原则-Dependency-Inversion-Principle" class="headerlink" title="依赖倒置原则(Dependency Inversion Principle)"></a>依赖倒置原则(Dependency Inversion Principle)</h4><div class="tabs" id="依赖倒置原则"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#依赖倒置原则-1">DIP</button></li><li class="tab"><button type="button" data-href="#依赖倒置原则-2">DIP Bad Case</button></li><li class="tab"><button type="button" data-href="#依赖倒置原则-3">DIP Good Case</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="依赖倒置原则-1"><p>依赖倒置原则（DIP ：Dependence Inversion Principle）：</p>
<ul>
<li>高层模块不应该依赖低层模块，二者都应该依赖其抽象</li>
<li>抽象不应该依赖细节</li>
<li>细节应该依赖抽象</li>
</ul>
<p><strong>也就是说高层模块，低层模块，细节都应该依赖抽象。</strong></p>
<p>  类 A 直接依赖类 B，假如要将类 B 改为类 C，则必须通过修改类 A 的代码来达成。 类 A 一般是高层模块，负责复杂的业务逻辑。 类 B 和类 C 是低层模块，负责基本的原子操作。 修改类 A，会给程序带来不必要的风险。</p>
<p> <strong>The original definition of the DIP states the following:</strong></p>
<ul>
<li><p><strong>A. High-level modules should not depend on low-level modules. Both should depend on abstractions.</strong><br>  What this statement basically means is that, if you’re interested in logging, your reporting component should not depend on a concrete ConsoleLogger, but can depend on an ILogger interface. In this case, we are considering the reporting component to be high level (closer to the business domain), whereas logging, being a fundamental concern (kind of like file I&#x2F;O or threading, but not quite) is considered a low-level module.</p>
</li>
<li><p><strong>B. Abstractions should not depend on details. Details should depend on abstractions.</strong><br>  This is, once again, restating that dependencies on interfaces or base classes are better than dependencies on concrete types. Hopefully the truth of this statement is obvious, because such an approach supports better configurability and testability—provided you’re using a good framework to handle these dependencies for you.</p>
</li>
</ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="依赖倒置原则-2"><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>

<span class="token comment">// a common vialation of the DIP in C++ </span>
<span class="token comment">// is when a high-level module depends on</span>
<span class="token comment">// a low-level module via a concrete class</span>
<span class="token comment">// rather than an abstraction.</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>

<span class="token keyword">class</span> <span class="token class-name">Database</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">insertData</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Inserting "</span> <span class="token operator">&lt;&lt;</span> data <span class="token operator">&lt;&lt;</span> <span class="token string">" into database."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">DataProcessor</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">processData</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token operator">></span><span class="token operator">&amp;</span> data<span class="token punctuation">,</span> Database database<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> d <span class="token operator">:</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            database<span class="token punctuation">.</span><span class="token function">insertData</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// in this exxamlple, the DataProcessor depends on </span>
<span class="token comment">// the Database class via a concrete class, rather than</span>
<span class="token comment">// an abstraction.This makes the DataProcessor tightly coupled</span>
<span class="token comment">// to the Database class, making it difficult to replace to </span>
<span class="token comment">// the Database class with a different implementation, or to </span>
<span class="token comment">// test the DataProcessor class in isolation.</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token operator">></span> data <span class="token punctuation">&#123;</span><span class="token string">"data1"</span><span class="token punctuation">,</span> <span class="token string">"data2"</span><span class="token punctuation">,</span> <span class="token string">"data3"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    Database database<span class="token punctuation">;</span>
    DataProcessor processor<span class="token punctuation">;</span>
    processor<span class="token punctuation">.</span><span class="token function">processData</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> database<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="依赖倒置原则-3"><p>To fix this vialation of the DIP, we can introduce an abstraction for the </p>
<p>Database class, such as an interface or abstract base class, and have the</p>
<p>DataProcessor depend on this abstraction rather than the concrete Database class.</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>

<span class="token keyword">class</span> <span class="token class-name">IDatabase</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">insertData</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> data<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">IDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Database</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">IDatabase</span></span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">insertData</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> data<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Inserting "</span> <span class="token operator">&lt;&lt;</span> data <span class="token operator">&lt;&lt;</span> <span class="token string">" into database."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">DataProcessor</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">processData</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token operator">></span><span class="token operator">&amp;</span> data<span class="token punctuation">,</span> IDatabase<span class="token operator">&amp;</span> database<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> d <span class="token operator">:</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            database<span class="token punctuation">.</span><span class="token function">insertData</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token operator">></span> data <span class="token punctuation">&#123;</span><span class="token string">"data1"</span><span class="token punctuation">,</span> <span class="token string">"data2"</span><span class="token punctuation">,</span> <span class="token string">"data3"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    Database database<span class="token punctuation">;</span>
    DataProcessor processor<span class="token punctuation">;</span>
    processor<span class="token punctuation">.</span><span class="token function">processData</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> database<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<br/>

<h4 id="合成-聚合复用原则-Composite-Aggregate-Reuse-Principle"><a href="#合成-聚合复用原则-Composite-Aggregate-Reuse-Principle" class="headerlink" title="合成&#x2F;聚合复用原则(Composite&#x2F;Aggregate Reuse Principle)"></a>合成&#x2F;聚合复用原则(Composite&#x2F;Aggregate Reuse Principle)</h4><div class="tabs" id="迪米特法则"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#迪米特法则-1">CARP</button></li><li class="tab"><button type="button" data-href="#迪米特法则-2">CARP Bad Case</button></li><li class="tab"><button type="button" data-href="#迪米特法则-3">CARP Good Case</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="迪米特法则-1"><p>组合&#x2F;聚合复用原则（CARP：Composite&#x2F;Aggregate Reuse Principle）：在一个新的对象里面使用一些已有的对象，使之成为新对象的一部分，新对象通过向这些对象的委派达到复用已有功能的目的。就是说要尽量的使用合成和聚合，而<strong>不是继承关系达到复用的目的</strong>。</p>
<p>简短表达就是：<strong>尽量使用组合&#x2F;聚合，尽量不要使用继承</strong>。</p>
<p>在面向对象的设计里，有两种基本的方法可以在不同的环境中复用已有的设计和实现，即通过<strong>组合</strong>或<strong>继承</strong>。</p>
<p><strong>组合</strong></p>
<p>由于组合可以将已有的对象纳入到新对象中，使之成为新对象的一部分，因此<strong>新对象可以调用已有对象的功能</strong>，这样做有下面的好处：</p>
<ul>
<li>新对象存取成分对象的唯一方法是通过<strong>成分对象的接口</strong></li>
<li>这种复用是<strong>黑箱复用</strong>，因为成分对象的内部细节是新对象所看不见的</li>
<li>这种复用所需的<strong>依赖较少</strong></li>
<li>每一个<strong>新的类</strong>可以将焦点<strong>集中在一个任务上</strong></li>
<li>这种复用可以在运行时间内动态进行，作为整体的新对象可以动态地引用与部分对象类型相同的对象。也就是说，<strong>组合&#x2F;聚合是动态行为</strong>，即运行时行为。可以通过使用组合&#x2F;聚合的方式在设计上获得更高的<strong>灵活性</strong></li>
</ul>
<p>组合复用的缺点就是用组合复用建造的系统会<strong>有较多的对象需要管理</strong>。</p>
<p><strong>继承</strong></p>
<p><strong>组合几乎可以用到任何环境中去，但是继承只能用到一些环境中</strong>。</p>
<p>继承复用通过扩展一个已有对象的实现来得到新的功能，基类明显的捕获共同的属性和方法，而子类通过增加新的属性和方法来扩展超类的实现。</p>
<p>继承的优点：</p>
<ul>
<li><strong>新的实现比较容易</strong>，因为基类的大部分功能都可以通过继承自动的进入子类。</li>
<li>修改或扩展继承而来的实现较为容易。</li>
</ul>
<p>继承的缺点：</p>
<ul>
<li><p>继承复用<strong>破坏了包装</strong>，因为继承超类的的实现细节暴露给子类。由于超类的内部细节常常对子类是透明的，因此这种复用是<strong>透明的复用</strong>，又称“白箱”复用。</p>
</li>
<li><p>如果<strong>超类的实现发生改变</strong>，那么<strong>子类的实现也不得不发生改变</strong>。因此，当一个基类发生改变时，这种改变就会像水中投入石子引起的水波一样，将变化一圈又一圈的传导到一级又一级的子类，使设计师不得不相应地改变这些子类，以适应超类的变化。</p>
</li>
<li><p>从超类继承而来的实现是<strong>静态的</strong>，不可能在运行时间内发生改变，因此<strong>没有足够的灵活性</strong>。</p>
</li>
</ul>
<p><strong>使用组合还是继承?</strong></p>
<p>满足 “Is-A” 的关系是才可以使用继承，而组合却是一种 “Has-A”（整体与部分）的关系。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="迪米特法则-2"><p>雇员、销售员、经理，这三者可以设计为人是基类、雇员和经理都继承于人(代码如下);</p>
<p>这种设计的错误在于把<strong>角色</strong>的等级结构和<strong>雇员</strong>的<strong>等级结构混淆</strong>了。经理、销售员是一个人的角色，<strong>一个人可以同时拥有上述角色</strong>。如果按继承来设计，那么如果<strong>一个人是销售员的话，就不可能是经理</strong>，这显然不合理。</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
  std<span class="token double-colon punctuation">::</span>string name_<span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Manager</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Employee</span></span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Sales</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Employee</span></span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="迪米特法则-3"><p>正确的设计是有个抽象类<strong>角色</strong>，人可以拥有<strong>多个角色（聚合）</strong>，销售员、经理是角色的子类(代码如下)；</p>
<p>这样做降低了类与类之间的耦合度，<code>Employee</code> 类的变化对其它类造成的影响相对较少。</p>
<p>从这个例子可以看出，<strong>当一个类是另一个类的角色时，不应该使用继承描述这种关系</strong>。</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
  std<span class="token double-colon punctuation">::</span>string name_<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Role<span class="token operator">></span> roles_<span class="token punctuation">;</span> <span class="token comment">// "Has-A"</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Role</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Manager</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Role</span></span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Sales</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Role</span></span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<br/>

<h4 id="迪米特法则-Law-of-Demeter"><a href="#迪米特法则-Law-of-Demeter" class="headerlink" title="迪米特法则(Law of Demeter)"></a>迪米特法则(Law of Demeter)</h4><div class="tabs" id="迪米特法则"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#迪米特法则-1">LOD</button></li><li class="tab"><button type="button" data-href="#迪米特法则-2">LOD Bad Case</button></li><li class="tab"><button type="button" data-href="#迪米特法则-3">LOD Good Case</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="迪米特法则-1"><p>  迪米特法则（LOD：Law Of Demeter）：又叫作<strong>最少知识原则</strong>（Least Knowledge Principle，LKP)。只与你的<strong>直接的</strong>朋友交谈，<strong>不跟“陌生人”说话</strong>（Talk only to your immediate friends and not to strangers）。其含义是：如果两个软件实体<strong>无须直接通信</strong>，那么就<strong>不应当发生直接的相互调用</strong>，可以通过第三方<strong>转发</strong>该调用。其目的是<strong>降低类之间的耦合度</strong>，提高模块的相对<strong>独立性</strong>。</p>
<p>  类与类之间的<strong>关系越密切</strong>，<strong>耦合度越大</strong>，当一个类发生改变时，对另一个类的<strong>影响也越大</strong>。</p>
<p>  <strong>每个类尽量减少对其他类的依赖</strong>。</p>
<p>迪米特法则要求<strong>限制</strong>软件实体之间<strong>通信的宽度和深度</strong>，正确使用迪米特法则将有以下两个优点。</p>
<ul>
<li><p>降低了类之间的<strong>耦合度</strong>，提高了模块的相对<strong>独立性</strong>。</p>
</li>
<li><p>由于亲合度降低，从而提高了<strong>类的可复用率</strong>和系统的<strong>扩展性</strong>。</p>
</li>
<li><p>迪米特法则中的“朋友”指什么？</p>
<p>当前<strong>对象本身、当前对象的成员对象、当前对象所创建的对象、当前对象的方法参数</strong>等，这些对象同当前对象<strong>存在关联、聚合或组合关系</strong>，<strong>可以直接访问</strong>这些对象的方法。</p>
</li>
<li><p>迪米特法则在强调什么？</p>
<ul>
<li>从依赖者的角度来说，<strong>只依赖应该依赖的对象</strong>。</li>
<li>从被依赖者的角度说，<strong>只暴露应该暴露的方法</strong>。</li>
</ul>
</li>
<li><p>如何实现迪米特法则？</p>
<ul>
<li>在<strong>类的划分</strong>上，应当尽量<strong>创建松耦合的类</strong>，类之间的耦合度越低，就越有利于复用，一个处在松耦合中的类一旦被修改，不会对关联的类造成太大波及。</li>
<li>在<strong>类的结构设计</strong>上，每一个类都应当尽量<strong>降低其成员变量和成员函数的访问权限</strong>。</li>
<li>在<strong>类的设计</strong>上，只要有可能，一个类型应当设计成<strong>不变类</strong>。</li>
<li>在<strong>对其他类的引用</strong>上，一个对象对其他对象的引用应当<strong>降到最低</strong>。</li>
<li><strong>不暴露类的属性成员</strong>，而应该提供相应的<strong>访问器</strong>（set 和 get 方法）。</li>
<li><strong>谨慎使用序列化（Serializable）功能</strong>：当通过序列化进行对象传输的时候，如果<strong>对象修改了属性的访问权限</strong>，而传输的另一方没有进行同步修改，则会报<strong>序列化失败</strong>。</li>
</ul>
<p>防止过度使用!!!</p>
<ul>
<li><strong>过度使用迪米特法则</strong>会使系统产生<strong>大量的中介类</strong>，从而增加系统的复杂性，使模块之间的<strong>通信效率降低</strong>。所以，在釆用迪米特法则时需要<strong>反复权衡</strong>，确保高内聚和低耦合的同时，保证系统的<strong>结构清晰</strong>。</li>
</ul>
</li>
</ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="迪米特法则-2"><p>States that the less a class knows about other classes, the better, which means an object should have as little knowledge as possible about other objects, communicate only with friends, and not talk to strangers.</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
  <span class="token keyword">int</span> id_<span class="token punctuation">;</span>
  string name_<span class="token punctuation">;</span>
  <span class="token comment">// ...</span>

<span class="token keyword">public</span><span class="token operator">:</span>
  std<span class="token double-colon punctuation">::</span>string <span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> name_<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Class</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
  <span class="token keyword">int</span> id_<span class="token punctuation">;</span>
  string name_<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Student<span class="token operator">*</span><span class="token operator">></span> sudents_<span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
  
<span class="token keyword">public</span><span class="token operator">:</span>
  std<span class="token double-colon punctuation">::</span>string <span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> name_<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Student<span class="token operator">*</span><span class="token operator">></span> <span class="token function">get_students</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> sudents_<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">School</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
  <span class="token keyword">int</span> address_<span class="token punctuation">;</span>
  string name_<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Class<span class="token operator">*</span><span class="token operator">></span> classes_<span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">:</span> classes_<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> cls<span class="token punctuation">.</span><span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
      <span class="token comment">// oops...</span>
      <span class="token keyword">auto</span> students <span class="token operator">=</span> cls<span class="token punctuation">.</span><span class="token function">get_students</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> s <span class="token operator">:</span> students<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span><span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="迪米特法则-3"><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
  <span class="token keyword">int</span> id_<span class="token punctuation">;</span>
  string name_<span class="token punctuation">;</span>
  <span class="token comment">// ...</span>

<span class="token keyword">public</span><span class="token operator">:</span>
  std<span class="token double-colon punctuation">::</span>string <span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> name_<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Class</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
  <span class="token keyword">int</span> id_<span class="token punctuation">;</span>
  string name_<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Student<span class="token operator">*</span><span class="token operator">></span> sudents_<span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
  
<span class="token keyword">public</span><span class="token operator">:</span>
  std<span class="token double-colon punctuation">::</span>string <span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> name_<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token comment">// std::vector&lt;Student*> get_students() &#123;</span>
  <span class="token comment">//   return sudents_;</span>
  <span class="token comment">// &#125;</span>
  <span class="token keyword">void</span> <span class="token function">PrintStudent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> s <span class="token operator">:</span> students_<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span><span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">School</span> <span class="token punctuation">&#123;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
  <span class="token keyword">int</span> address_<span class="token punctuation">;</span>
  string name_<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Class<span class="token operator">*</span><span class="token operator">></span> classes_<span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">:</span> classes_<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> cls<span class="token punctuation">.</span><span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
      <span class="token comment">// 调用班级打印学生名称的方法，</span>
      <span class="token comment">// 学校直接调用来打印，从而避免了与班级的学生发生耦合</span>
      cls<span class="token punctuation">.</span><span class="token function">PrintStudent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">JoyChen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2020/07/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%8E%9F%E5%88%99%E6%A6%82%E8%A6%81/">http://example.com/2020/07/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%8E%9F%E5%88%99%E6%A6%82%E8%A6%81/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">JoyChen's 知识星球</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></div><div class="post_share"><div class="social-share" data-image="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/img/random/material-3.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/07/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/design%20patterns/"><img class="prev-cover" src="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/img/random/material-3.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">常见设计模式</div></div></a></div><div class="next-post pull-right"><a href="/2020/03/13/%E7%A8%8B%E5%BA%8F%E8%B0%83%E8%AF%95/GDB%EF%BC%88LLDB%EF%BC%89%E8%B0%83%E8%AF%95%E6%96%B9%E6%B3%95/"><img class="next-cover" src="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/img/random/material-8.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">GDB(LLDB)调试方法</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/07/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/design%20patterns/" title="常见设计模式"><img class="cover" src="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/img/random/material-3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-13</div><div class="title">常见设计模式</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">JoyChen</div><div class="author-info__description">If you haven't found it yet Keep looking Don't settle</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">63</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">44</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/JoyChenNo1"><i class="fab fa-github"></i><span>关注我</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/JoyChenNo1" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:joychenisno1@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%B8%83%E5%A4%A7%E5%8E%9F%E5%88%99-The-7-Principles-of-Design-Patterns"><span class="toc-number">1.</span> <span class="toc-text">设计模式的七大原则(The 7 Principles of Design Patterns)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84-5-%E5%A4%A7%E5%8E%9F%E5%88%99-SOLID-%E5%85%B6%E4%BB%96-2-%E7%A7%8D%E5%8E%9F%E5%88%99"><span class="toc-number">1.1.</span> <span class="toc-text">面向对象的 5 大原则(SOLID) + 其他 2 种原则:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99-Single-Responsibility-Principle"><span class="toc-number">1.1.1.</span> <span class="toc-text">单一职责原则(Single Responsibility Principle)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99-Open-Closed-Principle"><span class="toc-number">1.1.2.</span> <span class="toc-text">开闭原则(Open Closed Principle)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8C%E6%B0%8F%E6%9B%BF%E6%8D%A2%E5%8E%9F%E5%88%99-Liskov-Substitution-Principle"><span class="toc-number">1.1.3.</span> <span class="toc-text">里氏替换原则(Liskov Substitution Principle)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%99-Interface-Segregation-Principle"><span class="toc-number">1.1.4.</span> <span class="toc-text">接口隔离原则(Interface Segregation Principle)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E5%80%92%E7%BD%AE%E5%8E%9F%E5%88%99-Dependency-Inversion-Principle"><span class="toc-number">1.1.5.</span> <span class="toc-text">依赖倒置原则(Dependency Inversion Principle)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%88%E6%88%90-%E8%81%9A%E5%90%88%E5%A4%8D%E7%94%A8%E5%8E%9F%E5%88%99-Composite-Aggregate-Reuse-Principle"><span class="toc-number">1.1.6.</span> <span class="toc-text">合成&#x2F;聚合复用原则(Composite&#x2F;Aggregate Reuse Principle)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%AA%E7%B1%B3%E7%89%B9%E6%B3%95%E5%88%99-Law-of-Demeter"><span class="toc-number">1.1.7.</span> <span class="toc-text">迪米特法则(Law of Demeter)</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/04/06/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/DDD%E6%80%9D%E6%83%B3%E5%8F%8A%E5%AE%9E%E8%B7%B5/" title="无题"><img src="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/img/bg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2024/04/06/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/DDD%E6%80%9D%E6%83%B3%E5%8F%8A%E5%AE%9E%E8%B7%B5/" title="无题">无题</a><time datetime="2024-04-06T14:39:47.172Z" title="发表于 2024-04-06 22:39:47">2024-04-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/14/%E5%B7%A5%E7%A8%8B%E6%9E%84%E5%BB%BA/Docker%20build/" title="Docker 基础镜像构建示例"><img src="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/img/random/material-2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker 基础镜像构建示例"/></a><div class="content"><a class="title" href="/2024/01/14/%E5%B7%A5%E7%A8%8B%E6%9E%84%E5%BB%BA/Docker%20build/" title="Docker 基础镜像构建示例">Docker 基础镜像构建示例</a><time datetime="2024-01-14T12:08:00.000Z" title="发表于 2024-01-14 20:08:00">2024-01-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/15/Go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B-Cond/" title="Go 并发编程-Condition"><img src="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/img/random/a/a6.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go 并发编程-Condition"/></a><div class="content"><a class="title" href="/2023/12/15/Go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B-Cond/" title="Go 并发编程-Condition">Go 并发编程-Condition</a><time datetime="2023-12-15T09:08:00.000Z" title="发表于 2023-12-15 17:08:00">2023-12-15</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/img/random/material-3.png')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2024 By JoyChen</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script></div><!-- hexo injector body_end start --><script src="https://cdn.jsdelivr.net/npm/hexo-tag-common@latest/js/index.js"></script><!-- hexo injector body_end end --></body></html>