<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.6 -->
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">













    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            拆书系列之《STL源码剖析》序列式容器（sequence containers） | 
        
        进阶之路
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content=",STL container">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?Dp7k2X9uh6CgQx67yceHxQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?CC5Yjp011Bf1QgvH2to+Cw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/tomorrow-night-bright.min.css?POjR8UWU/nzYlm7nv2wGjQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Monaco", Helvetica, "PingFang SC", "Hiragino Sans GB", Arial, sans-serif, monaco;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #333332 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #333332 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #333332 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #2a2d37;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="进阶之路">
    <meta name="msapplication-starturl" content="http://example.com/2021/06/06/STL/%E6%8B%86%E4%B9%A6%E7%B3%BB%E5%88%97%E4%B9%8B%E3%80%8ASTL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E3%80%8B%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%EF%BC%88sequence%20containers%EF%BC%89/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="进阶之路">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://example.com/2021/06/06/STL/%E6%8B%86%E4%B9%A6%E7%B3%BB%E5%88%97%E4%B9%8B%E3%80%8ASTL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E3%80%8B%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%EF%BC%88sequence%20containers%EF%BC%89/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="拆书系列之《STL源码剖析》序列式容器（sequence containers） | 进阶之路">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="">
    <meta property="og:article:tag" content="STL container"> 

    
        <meta property="article:published_time" content="Sun Jun 06 2021 23:43:09 GMT+0800">
        <meta property="article:modified_time" content="Sat Jun 12 2021 19:17:16 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://example.com/2021/06/06/STL/%E6%8B%86%E4%B9%A6%E7%B3%BB%E5%88%97%E4%B9%8B%E3%80%8ASTL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E3%80%8B%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%EF%BC%88sequence%20containers%EF%BC%89/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://example.com/2021/06/06/STL/%E6%8B%86%E4%B9%A6%E7%B3%BB%E5%88%97%E4%B9%8B%E3%80%8ASTL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E3%80%8B%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%EF%BC%88sequence%20containers%EF%BC%89/index.html",
    "headline": "拆书系列之《STL源码剖析》序列式容器（sequence containers）",
    "datePublished": "Sun Jun 06 2021 23:43:09 GMT+0800",
    "dateModified": "Sat Jun 12 2021 19:17:16 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "Joy Chen",
        "image": {
            "@type": "ImageObject",
            "url": "/img/me.png"
        },
        "description": "永远怀着一颗学徒的心"
    },
    "publisher": {
        "@type": "Organization",
        "name": "进阶之路",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",STL container",
    "description": "",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

<meta name="generator" content="Hexo 5.4.0"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E3%80%8ASTL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E3%80%8B%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%EF%BC%88sequence-containers%EF%BC%89"><span class="post-toc-number">1.</span> <span class="post-toc-text">《STL源码剖析》序列式容器（sequence containers）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#vector"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">vector</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#GCC-%E7%89%88%E6%9C%AC%E4%B8%8B%E7%9A%84-vector-%E4%BB%A3%E7%A0%81%E6%91%98%E8%A6%81"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">GCC 版本下的 vector 代码摘要</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#list"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">list</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#deque"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">deque</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#stack"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">stack</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#queue"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">queue</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#heap"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">heap</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#priority-queue"><span class="post-toc-number">1.4.1.</span> <span class="post-toc-text">priority_queue</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#slist"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">slist</span></a></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--6dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                拆书系列之《STL源码剖析》序列式容器（sequence containers）
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/me.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Joy Chen</strong>
        <span>6月 06, 2021</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-none-link" href="/tags/STL-container/" rel="tag">STL container</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=拆书系列之《STL源码剖析》序列式容器（sequence containers）&url=http://example.com/2021/06/06/STL/%E6%8B%86%E4%B9%A6%E7%B3%BB%E5%88%97%E4%B9%8B%E3%80%8ASTL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E3%80%8B%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%EF%BC%88sequence%20containers%EF%BC%89/index.html&via=Joy Chen" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://example.com/2021/06/06/STL/%E6%8B%86%E4%B9%A6%E7%B3%BB%E5%88%97%E4%B9%8B%E3%80%8ASTL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E3%80%8B%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%EF%BC%88sequence%20containers%EF%BC%89/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://example.com/2021/06/06/STL/%E6%8B%86%E4%B9%A6%E7%B3%BB%E5%88%97%E4%B9%8B%E3%80%8ASTL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E3%80%8B%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%EF%BC%88sequence%20containers%EF%BC%89/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    
        <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=http://example.com/2021/06/06/STL/%E6%8B%86%E4%B9%A6%E7%B3%BB%E5%88%97%E4%B9%8B%E3%80%8ASTL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E3%80%8B%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%EF%BC%88sequence%20containers%EF%BC%89/index.html&title=拆书系列之《STL源码剖析》序列式容器（sequence containers）" target="_blank">
            <li class="mdl-menu__item">
                分享到 LinkedIn
            </li>
        </a>
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=进阶之路&title=拆书系列之《STL源码剖析》序列式容器（sequence containers）&summary=&pics=http://example.com/img/favicon.png&url=http://example.com/2021/06/06/STL/%E6%8B%86%E4%B9%A6%E7%B3%BB%E5%88%97%E4%B9%8B%E3%80%8ASTL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E3%80%8B%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%EF%BC%88sequence%20containers%EF%BC%89/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="《STL源码剖析》序列式容器（sequence-containers）"><a href="#《STL源码剖析》序列式容器（sequence-containers）" class="headerlink" title="《STL源码剖析》序列式容器（sequence containers）"></a>《STL源码剖析》序列式容器（sequence containers）</h1><p><code>参考自《STL 源码剖析》-侯捷著。</code></p>
<img src="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/public/img/STL/%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8.png">

<h2 id="vector"><a href="#vector" class="headerlink" title="vector"></a>vector</h2><p><code>vector 的实现技术，关键在于其对大小的控制和重新配置时到的数据移动效率。</code></p>
<h3 id="GCC-版本下的-vector-代码摘要"><a href="#GCC-版本下的-vector-代码摘要" class="headerlink" title="GCC 版本下的 vector 代码摘要"></a>GCC 版本下的 vector 代码摘要</h3><p><code>stl_vector.h 定义的 vector 会调用到 vector.tcc 里的模板方法，基本以如 _M_xxx_xxx_xxx() 命名。</code></p>
<blockquote>
<pre><code class="cpp">template&lt;typename _Tp, typename _Alloc = std::allocator&lt;_Tp&gt; &gt;
class vector : protected _Vector_base&lt;_Tp, _Alloc&gt; &#123;
public:
    typedef _Tp                                                                            value_type;
    typedef typename _Base::pointer                                    pointer;
    typedef typename _Alloc_traits::const_pointer        const_pointer;
    typedef typename _Alloc_traits::reference                reference;
    typedef typename _Alloc_traits::const_reference    const_reference;
    typedef __gnu_cxx::__normal_iterator&lt;pointer, vector&gt; iterator;
    typedef __gnu_cxx::__normal_iterator&lt;const_pointer, vector&gt; const_iterator;
    typedef std::reverse_iterator&lt;const_iterator&gt;        const_reverse_iterator;
    typedef std::reverse_iterator&lt;iterator&gt;                reverse_iterator;
    typedef size_t                                                                    size_type;
    typedef ptrdiff_t                                                                difference_type;
    typedef _Alloc                                                                    allocator_type;
  // ...
&#125;;
</code></pre>
</blockquote>
<p><strong>vector 的迭代器</strong></p>
<p>普通指针<strong>具备随机存取</strong>的能力。</p>
<blockquote>
<pre><code class="cpp">typedef typename _Base::pointer                                                pointer;
typedef __gnu_cxx::__normal_iterator&lt;pointer, vector&gt; iterator;
</code></pre>
</blockquote>
<p><strong>vector 的数据结构</strong></p>
<blockquote>
<pre><code class="cpp">template&lt;typename _Tp, typename _Alloc&gt;
struct _Vector_base &#123;
//...
  struct _Vector_impl_data &#123;
    pointer _M_start;     // 表示目前使用空间的头
    pointer _M_finish;    // 表示目前使用空间的尾
    pointer _M_end_of_storage;    // 表示目前可用空间的尾
  &#125;;
  struct _Vector_impl : public _Tp_alloc_type, public _Vector_impl_data &#123;
    // ...
  &#125;
  
  public:
    _Vector_impl _M_impl;
  protected:
    void _M_create_storage(size_t __n) &#123;
      this-&gt;_M_impl._M_start = this-&gt;_M_allocate(__n);
      this-&gt;_M_impl._M_finish = this-&gt;_M_impl._M_start;
      this-&gt;_M_impl._M_end_of_storage = this-&gt;_M_impl._M_start + __n;
    &#125;
&#125;;
</code></pre>
</blockquote>
<p>有了<code>_M_start</code> <code>_M_finish</code> <code>_M_end_of_storage</code>这三个迭代器，可以轻松提供 <code>begin()</code>、 <code>end()</code> 、<code>size()</code> 、<code>capacity()</code>、 <code>empty()</code>、 <code>operator[]</code> 、<code>front()</code>、<code>back()</code>接口。</p>
<img src="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/public/img/STL/vector.png">

<br/>

<p><strong>vector 初始化</strong></p>
<blockquote>
<pre><code class="cpp"> // Called by the first initialize_dispatch above and by the
// vector(n,value,a) constructor.
// 填充并予以初始化
void _M_fill_initialize(size_type __n, const value_type&amp; __value) &#123;
    this-&gt;_M_impl._M_finish =
      std::__uninitialized_fill_n_a(this-&gt;_M_impl._M_start, __n, __value,
                                    _M_get_Tp_allocator());
&#125;

template&lt;typename _ForwardIterator, typename _Size, typename _Tp&gt;
inline _ForwardIterator
uninitialized_fill_n(_ForwardIterator __first, _Size __n, const _Tp&amp; __x) &#123;
  typedef typename iterator_traits&lt;_ForwardIterator&gt;::value_type
     _ValueType;
     // Trivial types can have deleted assignment, so using std::fill
    // would be ill-formed. Require assignability before using std::fill:
    const bool __assignable = is_copy_assignable&lt;_ValueType&gt;::value;
    // 配置后填充
    return __uninitialized_fill_n&lt;__is_trivial(_ValueType) &amp;&amp; __assignable&gt;::
    __uninit_fill_n(__first, __n, __x);
  &#125;

//针对 trivial constructor 的特化版本，调用 std::fill_n
template&lt;&gt;
struct __uninitialized_fill_n&lt;true&gt; &#123;
  template&lt;typename _ForwardIterator, typename _Size, typename _Tp&gt;
    static _ForwardIterator
    __uninit_fill_n(_ForwardIterator __first, _Size __n, const _Tp&amp; __x) &#123; 
      return std::fill_n(__first, __n, __x); &#125;
   &#125;;
  
//针对 non trivial constructor 的特化版本，调用 ::new
template&lt;bool _TrivialValueType&gt;
struct __uninitialized_fill_n &#123;
  template&lt;typename _ForwardIterator, typename _Size, typename _Tp&gt;
  static _ForwardIterator
    __uninit_fill_n(_ForwardIterator __first, _Size __n,
                   const _Tp&amp; __x) &#123;
       _ForwardIterator __cur = __first;
        __try &#123;
          for (; __n &gt; 0; --__n, (void) ++__cur)
            std::_Construct(std::__addressof(*__cur), __x);
          return __cur;
        &#125;
        __catch(...) &#123;
          std::_Destroy(__first, __cur);
          __throw_exception_again;
        &#125;
     &#125;
   &#125;;
</code></pre>
</blockquote>
<p><strong>vector 插入</strong></p>
<blockquote>
<pre><code class="cpp">void push_back(const value_type&amp; __x) &#123;
  // 还有备用空间
  if (this-&gt;_M_impl._M_finish != this-&gt;_M_impl._M_end_of_storage) &#123;
   _GLIBCXX_ASAN_ANNOTATE_GROW(1);
   _Alloc_traits::construct(this-&gt;_M_impl, this-&gt;_M_impl._M_finish,
                            __x);
   ++this-&gt;_M_impl._M_finish;
   _GLIBCXX_ASAN_ANNOTATE_GREW(1);
  &#125;
  // 无备用空间
  else
   _M_realloc_insert(end(), __x);
&#125;

// _M_realloc_insert
template&lt;typename _Tp, typename _Alloc&gt;
template&lt;typename... _Args&gt;
void vector&lt;_Tp, _Alloc&gt;:: _M_realloc_insert(iterator __position, _Args&amp;&amp;... __args)
&#123;
  const size_type __len = _M_check_len(size_type(1), &quot;vector::_M_realloc_insert&quot;);
  pointer __old_start = this-&gt;_M_impl._M_start;
  pointer __old_finish = this-&gt;_M_impl._M_finish;
  const size_type __elems_before = __position - begin();
  pointer __new_start(this-&gt;_M_allocate(__len));
  pointer __new_finish(__new_start);
  __try &#123;
    // 配置大小为原来的2倍
    _Alloc_traits::construct(this-&gt;_M_impl,
                             __new_start + __elems_before,
                             std::forward&lt;_Args&gt;(__args)...);
    __new_finish = pointer();

    if _GLIBCXX17_CONSTEXPR (_S_use_relocate()) &#123;
      __new_finish = _S_relocate(__old_start, __position.base(),
                                 __new_start, _M_get_Tp_allocator());

      ++__new_finish;

      __new_finish = _S_relocate(__position.base(), __old_finish,
                                 __new_finish, _M_get_Tp_allocator());
    &#125; else &#123;
      // 将原来 vector 的内容拷到新的 vector
      // std::__uninitialized_move_if_noexcept_a() 最终会调用到
      // std::uninitialized_copy()
      __new_finish = std::__uninitialized_move_if_noexcept_a (__old_start,                                                        __position.base(), __new_start, _M_get_Tp_allocator());

      ++__new_finish;
            
      __new_finish = std::__uninitialized_move_if_noexcept_a(__position.base(),                                     __old_finish,  __new_finish, _M_get_Tp_allocator());
    &#125;
  &#125;
  __catch(...) &#123;
    if (!__new_finish)
      _Alloc_traits::destroy(this-&gt;_M_impl,  __new_start + __elems_before);
    else
      std::_Destroy(__new_start, __new_finish, _M_get_Tp_allocator());
    _M_deallocate(__new_start, __len);
    __throw_exception_again;
  &#125;
  // 析构并释放原 vector
  if _GLIBCXX17_CONSTEXPR (!_S_use_relocate())
    std::_Destroy(__old_start, __old_finish, _M_get_Tp_allocator());
  _GLIBCXX_ASAN_ANNOTATE_REINIT;
  _M_deallocate(__old_start, this-&gt;_M_impl._M_end_of_storage - __old_start);
  // 调整迭代器，指向新的 vector
  this-&gt;_M_impl._M_start = __new_start;
  this-&gt;_M_impl._M_finish = __new_finish;
  this-&gt;_M_impl._M_end_of_storage = __new_start + __len;
&#125;
</code></pre>
</blockquote>
<blockquote>
<pre><code class="cpp">/**
*  @brief  Inserts given rvalue into %vector before specified iterator.
*  @param  __position  A const_iterator into the %vector.
*  @param  __x  Data to be inserted.
*  @return  An iterator that points to the inserted data.
*
*  This function will insert a copy of the given rvalue before
*  the specified location.  Note that this kind of operation
*  could be expensive for a %vector and if it is frequently
*  used the user should consider using std::list.
*/
iterator insert(const_iterator __position, value_type&amp;&amp; __x) &#123; 
  return _M_insert_rval(__position, std::move(__x)); 
&#125;

template&lt;typename _Tp, typename _Alloc&gt;
auto vector&lt;_Tp, _Alloc&gt;::
    _M_insert_rval(const_iterator __position, value_type&amp;&amp; __v) -&gt; iterator &#123;
      const auto __n = __position - cbegin();
      if (this-&gt;_M_impl._M_finish != this-&gt;_M_impl._M_end_of_storage)
        if (__position == cend()) &#123;
            _GLIBCXX_ASAN_ANNOTATE_GROW(1);
            _Alloc_traits::construct(this-&gt;_M_impl, this-&gt;_M_impl._M_finish,
                   std::move(__v));
            ++this-&gt;_M_impl._M_finish;
            _GLIBCXX_ASAN_ANNOTATE_GREW(1);
          &#125;
        else
          _M_insert_aux(begin() + __n, std::move(__v));
      else
        _M_realloc_insert(begin() + __n, std::move(__v));

      return iterator(this-&gt;_M_impl._M_start + __n);
 &#125;


/** @file bits/vector.tcc
 *  This is an internal header file, included by other library headers.
 *  Do not attempt to use it directly. @headername&#123;vector&#125;
 */

template&lt;typename _Alloc&gt;
void vector&lt;bool, _Alloc&gt;::_M_insert_aux(iterator __position, bool __x) &#123;
  if (this-&gt;_M_impl._M_finish._M_p != this-&gt;_M_impl._M_end_addr()) &#123;
    std::copy_backward(__position, this-&gt;_M_impl._M_finish, 
                       this-&gt;_M_impl._M_finish + 1);
    *__position = __x;
    ++this-&gt;_M_impl._M_finish;
  &#125; else &#123;
    const size_type __len =
      _M_check_len(size_type(1), &quot;vector&lt;bool&gt;::_M_insert_aux&quot;);
    _Bit_pointer __q = this-&gt;_M_allocate(__len);
    iterator __start(std::__addressof(*__q), 0);
    iterator __i = _M_copy_aligned(begin(), __position, __start);
    *__i++ = __x;
    iterator __finish = std::copy(__position, end(), __i);
    this-&gt;_M_deallocate();
    this-&gt;_M_impl._M_end_of_storage = __q + _S_nword(__len);
    this-&gt;_M_impl._M_start = __start;
    this-&gt;_M_impl._M_finish = __finish;
  &#125;
&#125;
</code></pre>
</blockquote>
<blockquote>
<pre><code class="cpp">iterator insert(const_iterator __position, initializer_list&lt;value_type&gt; __l) &#123;
  auto __offset = __position - cbegin();
  _M_range_insert(begin() + __offset, __l.begin(), __l.end(),
                  std::random_access_iterator_tag());
  return begin() + __offset;
&#125;


template&lt;typename _Tp, typename _Alloc&gt;
template&lt;typename _ForwardIterator&gt;
void vector&lt;_Tp, _Alloc&gt;::_M_range_insert(iterator __position, 
                                          _ForwardIterator __first,
                                                                                 _ForwardIterator __last, 
                                          std::forward_iterator_tag) &#123;
    if (__first != __last) &#123;
    const size_type __n = std::distance(__first, __last);
    // 备用空间 &gt;= 新增元素个数
    if (size_type(this-&gt;_M_impl._M_end_of_storage
                  - this-&gt;_M_impl._M_finish) &gt;= __n) &#123;
      // 计算插入点之后的现有元素个数
      const size_type __elems_after = end() - __position;
      pointer __old_finish(this-&gt;_M_impl._M_finish);
      // 插入点之后现有的元素个数 &gt; 新增元素个数
      if (__elems_after &gt; __n) &#123;
        _GLIBCXX_ASAN_ANNOTATE_GROW(__n);
        std::__uninitialized_move_a(this-&gt;_M_impl._M_finish - __n,
                                    this-&gt;_M_impl._M_finish,
                                    this-&gt;_M_impl._M_finish,
                                    _M_get_Tp_allocator());
        this-&gt;_M_impl._M_finish += __n; // 将 vector 尾端标记后移
        _GLIBCXX_ASAN_ANNOTATE_GREW(__n);
        _GLIBCXX_MOVE_BACKWARD3(__position.base(),
                                __old_finish - __n, __old_finish);
        std::copy(__first, __last, __position); // 插入点开始插入新值
      &#125; else &#123;
        // 插入点之后现有的元素个数 &lt;= 新增元素个数
        _ForwardIterator __mid = __first;
        std::advance(__mid, __elems_after);
        _GLIBCXX_ASAN_ANNOTATE_GROW(__n);
        std::__uninitialized_copy_a(__mid, __last,
                                    this-&gt;_M_impl._M_finish,
                                    _M_get_Tp_allocator());
        this-&gt;_M_impl._M_finish += __n - __elems_after;
        _GLIBCXX_ASAN_ANNOTATE_GREW(__n - __elems_after);
        std::__uninitialized_move_a(__position.base(),
                                    __old_finish,
                                    this-&gt;_M_impl._M_finish,
                                    _M_get_Tp_allocator());
        this-&gt;_M_impl._M_finish += __elems_after;
        _GLIBCXX_ASAN_ANNOTATE_GREW(__elems_after);
        std::copy(__first, __mid, __position);
      &#125;
     &#125; else &#123;
      // 配置新的 vector 空间
      const size_type __len = _M_check_len(__n, &quot;vector::_M_range_insert&quot;);
      pointer __new_start(this-&gt;_M_allocate(__len));
      pointer __new_finish(__new_start);
      __try &#123;
          // 1、先将旧 vector 的插入点之前的元素 copy 到新空间
          __new_finish = std::__uninitialized_move_if_noexcept_a
            (this-&gt;_M_impl._M_start, __position.base(),
             __new_start, _M_get_Tp_allocator());
        
            // 2、将新增元素 copy 到新空间
          __new_finish = std::__uninitialized_copy_a(__first, __last,
                  __new_finish,
                  _M_get_Tp_allocator());
          // 3、将旧 vector 的插入点之后的元素 copy 到新空间
          __new_finish = std::__uninitialized_move_if_noexcept_a(__position.base(),                                                                                             this-&gt;_M_impl._M_finish,
                                              __new_finish, _M_get_Tp_allocator());
      &#125;
      __catch(...) &#123;
          std::_Destroy(__new_start, __new_finish,
            _M_get_Tp_allocator());
          _M_deallocate(__new_start, __len);
          __throw_exception_again;
      &#125;
      // 清除释放旧的 vector
      std::_Destroy(this-&gt;_M_impl._M_start, this-&gt;_M_impl._M_finish,
              _M_get_Tp_allocator());
      _GLIBCXX_ASAN_ANNOTATE_REINIT;
      _M_deallocate(this-&gt;_M_impl._M_start,
              this-&gt;_M_impl._M_end_of_storage
              - this-&gt;_M_impl._M_start);
      // 调整迭代器，指向新的 vector
      this-&gt;_M_impl._M_start = __new_start;
      this-&gt;_M_impl._M_finish = __new_finish;
      this-&gt;_M_impl._M_end_of_storage = __new_start + __len;
      &#125;
    &#125;
&#125;
</code></pre>
</blockquote>
<blockquote>
<pre><code class="cpp">template&lt;typename _Tp, typename _Alloc&gt;
void vector&lt;_Tp, _Alloc&gt;::
    _M_fill_insert(iterator __position, size_type __n, const value_type&amp; __x) &#123;
  if (__n != 0) &#123;
    // 备用空间 &gt;= 新增元素个数
      if (size_type(this-&gt;_M_impl._M_end_of_storage - this-&gt;_M_impl._M_finish) 
        &gt;= __n) &#123;
      _Temporary_value __tmp(this, __x);
      value_type&amp; __x_copy = __tmp._M_val();
      const size_type __elems_after = end() - __position;
      pointer __old_finish(this-&gt;_M_impl._M_finish);
      if (__elems_after &gt; __n) &#123;
        // 插入点之后现有的元素个数 &gt; 新增元素个数
        _GLIBCXX_ASAN_ANNOTATE_GROW(__n);
        std::__uninitialized_move_a(this-&gt;_M_impl._M_finish - __n,
                                    this-&gt;_M_impl._M_finish,
                                    this-&gt;_M_impl._M_finish,
                                    _M_get_Tp_allocator());
        this-&gt;_M_impl._M_finish += __n;
        _GLIBCXX_ASAN_ANNOTATE_GREW(__n);
        _GLIBCXX_MOVE_BACKWARD3(__position.base(),
                                __old_finish - __n, __old_finish);
        std::fill(__position.base(), __position.base() + __n, __x_copy);
            &#125; else &#123;
        // 插入点之后现有的元素个数 &lt;= 新增元素个数
          _GLIBCXX_ASAN_ANNOTATE_GROW(__n);
          this-&gt;_M_impl._M_finish =
            std::__uninitialized_fill_n_a(this-&gt;_M_impl._M_finish,
                  __n - __elems_after,
                  __x_copy,
                  _M_get_Tp_allocator());
          _GLIBCXX_ASAN_ANNOTATE_GREW(__n - __elems_after);
          std::__uninitialized_move_a(__position.base(), __old_finish,
                    this-&gt;_M_impl._M_finish,
                    _M_get_Tp_allocator());
          this-&gt;_M_impl._M_finish += __elems_after;
          _GLIBCXX_ASAN_ANNOTATE_GREW(__elems_after);
          std::fill(__position.base(), __old_finish, __x_copy);
            &#125;
      &#125; else &#123;
      // 配置新的 vector 空间
          const size_type __len =
                _M_check_len(__n, &quot;vector::_M_fill_insert&quot;);
          const size_type __elems_before = __position - begin();
          pointer __new_start(this-&gt;_M_allocate(__len));
          pointer __new_finish(__new_start);
          __try &#123;
          // 1、将新增元素以初值为__n, fill 到新空间
          std::__uninitialized_fill_n_a(__new_start + __elems_before,
                __n, __x,
                _M_get_Tp_allocator());
          
          __new_finish = pointer();
                    // 2、将旧 vector 的插入点之前的元素 copy 到新空间
          __new_finish
            = std::__uninitialized_move_if_noexcept_a
            (this-&gt;_M_impl._M_start, __position.base(),
             __new_start, _M_get_Tp_allocator());

          __new_finish += __n;
                    // 3、将旧 vector 的插入点之后的元素 copy 到新空间
          __new_finish = std::__uninitialized_move_if_noexcept_a(__position.base(), 
                                                 this-&gt;_M_impl._M_finish,
                                                 __new_finish, _M_get_Tp_allocator());
                &#125;
          __catch(...) &#123;
          if (!__new_finish)
            std::_Destroy(__new_start + __elems_before,
              __new_start + __elems_before + __n,
              _M_get_Tp_allocator());
          else
            std::_Destroy(__new_start, __new_finish, _M_get_Tp_allocator());
          _M_deallocate(__new_start, __len);
          __throw_exception_again;
        &#125;
      
        // 清除释放旧的 vector
          std::_Destroy(this-&gt;_M_impl._M_start, this-&gt;_M_impl._M_finish,
                _M_get_Tp_allocator());
          _GLIBCXX_ASAN_ANNOTATE_REINIT;
          _M_deallocate(this-&gt;_M_impl._M_start,
                this-&gt;_M_impl._M_end_of_storage - this-&gt;_M_impl._M_start);
        
        // 调整迭代器，指向新的 vector
          this-&gt;_M_impl._M_start = __new_start;
          this-&gt;_M_impl._M_finish = __new_finish;
          this-&gt;_M_impl._M_end_of_storage = __new_start + __len;
        &#125;
    &#125;
&#125;
</code></pre>
</blockquote>
<br/>

<img src="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/public/img/STL/vector-insert.png">

<br/>

<p><strong>vector 擦除</strong></p>
<blockquote>
<pre><code class="cpp">// 清除某个位置的元素
template&lt;typename _Tp, typename _Alloc&gt;
typename vector&lt;_Tp, _Alloc&gt;::iterator
  vector&lt;_Tp, _Alloc&gt;::_M_erase(iterator __position) &#123;
  if (__position + 1 != end())
    _GLIBCXX_MOVE3(__position + 1, end(), __position);
  --this-&gt;_M_impl._M_finish;
  _Alloc_traits::destroy(this-&gt;_M_impl, this-&gt;_M_impl._M_finish);
  _GLIBCXX_ASAN_ANNOTATE_SHRINK(1);
  return __position;
&#125;

// 清除 [first, last) 中的所有元素
template&lt;typename _Tp, typename _Alloc&gt;
typename vector&lt;_Tp, _Alloc&gt;::iterator
  vector&lt;_Tp, _Alloc&gt;::_M_erase(iterator __first, iterator __last) &#123;
  if (__first != __last) &#123;
    if (__last != end())
      _GLIBCXX_MOVE3(__last, end(), __first);
    _M_erase_at_end(__first.base() + (end() - __last));
  &#125;
  return __first;
&#125;
</code></pre>
</blockquote>
<p>​    <br/></p>
<img src="https://github.com/JoyChenNo1/JoyChenNo1.github.io/raw/master/public/img/STL/vector-erase.png">

<br/>

<br/>

<h2 id="list"><a href="#list" class="headerlink" title="list"></a>list</h2><br/>

<h2 id="deque"><a href="#deque" class="headerlink" title="deque"></a>deque</h2><br/>

<h3 id="stack"><a href="#stack" class="headerlink" title="stack"></a>stack</h3><br/>

<h3 id="queue"><a href="#queue" class="headerlink" title="queue"></a>queue</h3><br/>

<h2 id="heap"><a href="#heap" class="headerlink" title="heap"></a>heap</h2><br/>

<h3 id="priority-queue"><a href="#priority-queue" class="headerlink" title="priority_queue"></a>priority_queue</h3><br/>

<h2 id="slist"><a href="#slist" class="headerlink" title="slist"></a>slist</h2><br/>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2021/05/31/STL/%E6%8B%86%E4%B9%A6%E7%B3%BB%E5%88%97%E4%B9%8B%E3%80%8ASTL%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E3%80%8B%E8%BF%AD%E4%BB%A3%E5%99%A8%EF%BC%88iterators%EF%BC%89/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/me.png" alt="Joy Chen's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        joychenisno1@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="joychenisno1@gmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2021/06/">六月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/05/">五月 2021<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/03/">三月 2021<span class="sidebar_archives-count">5</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/C-%E6%96%B0%E7%89%B9%E6%80%A7/">C++新特性<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/categories/STL/">STL<span class="sidebar_archives-count">4</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    

    <!-- Segmentfault -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;<span year></span>&nbsp;进阶之路
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?Bn9UzEm8RrBSxqyZB0zPjA==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('
<link rel="stylesheet" href="/css/uc.css">
');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 0000;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
